---
title: 'testing time.sleep'
date: 2026-02-15
desc:
thumbnail: /team-member-1.jpeg
category: Go
open: true
---

```go
type Handler struct {
	n int
	publisher publisher
}

type publisher interface {
	Publish([]Foo)
}

func (h Handler) getBestFoo(someInputs int) Foo {
	foos := getFoos(someInputs)
	best := foos[0]
	go func() {
		if len(foos) > h.n {
			foos = foos[:h.n]
		}
		h.publisher.Publish(foos)
	}()
	
	return best
}


// testing

func TestGetBestFoo(t *testing.T) {
	mock := publisherMock1{}
	h := Handler{
		publisher: &mock,
		n:         2,
	}

	foo := h.getBestFoo(42)
	// Check foo
	_ = foo

	time.Sleep(10 * time.Millisecond)
	published := mock.Get()
	// Check published
	_ = published
}

```
